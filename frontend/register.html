<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register | AI-Proctored Quiz</title>
  <meta name="description" content="Register as a student on the AI-Proctored Quiz System." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --yellow: #FFE500; --pink: #FF3BFF; --cyan: #00D9FF; --lime: #00FF85;
      --black: #0a0a0a; --white: #FAFAFA;
      --shadow: 6px 6px 0 var(--black); --shadow-lg: 8px 8px 0 var(--black);
    }
    body {
      font-family: 'Space Grotesk', sans-serif;
      background: var(--white);
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      background-image:
        repeating-linear-gradient(0deg, transparent, transparent 39px, rgba(0,0,0,0.07) 39px, rgba(0,0,0,0.07) 40px),
        repeating-linear-gradient(90deg, transparent, transparent 39px, rgba(0,0,0,0.07) 39px, rgba(0,0,0,0.07) 40px);
      padding: 20px;
    }
    .card { width: 100%; max-width: 460px; border: 4px solid var(--black); box-shadow: var(--shadow-lg); background: var(--white); }
    .card-header { background: var(--lime); padding: 24px 32px; border-bottom: 4px solid var(--black); }
    .card-header h1 { font-size: 26px; font-weight: 800; text-transform: uppercase; letter-spacing: -1px; }
    .card-header p { font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; opacity: 0.6; margin-top: 4px; }
    .card-body { padding: 32px; }
    .form-group { margin-bottom: 18px; }
    label { display: block; font-size: 11px; font-weight: 800; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 6px; }
    input { width: 100%; padding: 12px 14px; border: 3px solid var(--black); background: var(--white); font-family: inherit; font-size: 15px; font-weight: 600; outline: none; transition: box-shadow 0.15s; }
    input:focus { box-shadow: var(--shadow); }
    input::placeholder { color: #aaa; font-weight: 500; }
    .btn-primary { width: 100%; padding: 14px; background: var(--lime); border: 3px solid var(--black); font-family: inherit; font-size: 15px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; box-shadow: var(--shadow); transition: transform 0.1s, box-shadow 0.1s; margin-top: 8px; }
    .btn-primary:hover { transform: translate(-3px,-3px); box-shadow: 9px 9px 0 var(--black); }
    .btn-primary:active { transform: translate(3px,3px); box-shadow: 3px 3px 0 var(--black); }
    .error-msg { background: var(--pink); border: 3px solid var(--black); padding: 10px 14px; font-size: 13px; font-weight: 700; margin-top: 12px; display: none; }
    .error-msg.show { display: block; }
    .success-msg { background: var(--lime); border: 3px solid var(--black); padding: 10px 14px; font-size: 13px; font-weight: 700; margin-top: 12px; display: none; }
    .success-msg.show { display: block; }
    .login-link { text-align: center; margin-top: 20px; font-size: 13px; font-weight: 600; }
    .login-link a { color: var(--black); font-weight: 800; text-decoration: underline; }
    .req-note { font-size: 11px; font-weight: 600; color: #666; margin-top: 4px; }
  </style>
</head>
<body>
<div class="card">
  <div class="card-header">
    <h1>Student Register</h1>
    <p>Create your quiz account</p>
  </div>
  <div class="card-body">
    <form id="register-form" onsubmit="handleRegister(event)">
      <div class="form-group">
        <label for="univ">University Number</label>
        <input type="text" id="univ" placeholder="e.g. CS2021001" required />
        <div class="req-note">This is your unique student ID</div>
      </div>
      <div class="form-group">
        <label for="name">Full Name</label>
        <input type="text" id="name" placeholder="John Doe" required />
      </div>
      <div class="form-group">
        <label for="email">Email Address</label>
        <input type="email" id="email" placeholder="john@university.edu" required />
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" id="password" placeholder="Min 6 characters" minlength="6" required />
      </div>
      <button type="submit" class="btn-primary" id="register-btn">Create Account →</button>
      <div class="error-msg" id="error-msg"></div>
      <div class="success-msg" id="success-msg"></div>
    </form>
    <div class="login-link">Already registered? <a href="login.html">Login here</a></div>
  </div>
</div>

<script>
  const API = "https://fullstack-quiz-mhq2.onrender.com";

  async function handleRegister(e) {
    e.preventDefault();
    const btn = document.getElementById('register-btn');
    btn.textContent = 'Creating...'; btn.disabled = true;

    const payload = {
      university_number: document.getElementById('univ').value.trim(),
      name: document.getElementById('name').value.trim(),
      email: document.getElementById('email').value.trim(),
      password: document.getElementById('password').value,
    };

    try {
      const res = await fetch(`${API}/student/register`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
      const data = await res.json();
      if (!res.ok) throw new Error(data.detail || 'Registration failed');

      const s = document.getElementById('success-msg');
      s.textContent = '✅ Registered! Redirecting to login...';
      s.classList.add('show');
      setTimeout(() => window.location.href = 'login.html', 2000);
    } catch (err) {
      const e = document.getElementById('error-msg');
      e.textContent = '❌ ' + err.message;
      e.classList.add('show');
      setTimeout(() => e.classList.remove('show'), 4000);
    } finally {
      btn.textContent = 'Create Account →'; btn.disabled = false;
    }
  }
</script>
</body>
</html>
